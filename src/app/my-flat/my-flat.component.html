<div class="wrap">
  <header class="toolbar">
    <h1>My Flats</h1>
    <a class="btn primary" routerLink="/new-flat">+ Insert new flat</a>
  </header>

  <div *ngIf="loading()" class="state muted">Loading…</div>
  <div *ngIf="!loading() && error()" class="state error">{{ error() }}</div>

  <div *ngIf="!loading() && !error() && rows().length === 0" class="empty">
    <p>You haven’t published any flats yet.</p>
    <a class="btn primary" routerLink="/new-flat">Publish your first flat</a>
  </div>

  <ul *ngIf="rows().length" class="list">
    <li class="row" *ngFor="let f of rows()" (click)="toView($event, f.id)">
      <div class="thumb">
        <img [src]="f.image || 'assets/placeholder.jpg'"
             [alt]="f.title || (f.city + ' · ' + f.streetName)" />
      </div>

      <div class="body">
        <h3 class="title">{{ f.title || (f.city + ' · ' + f.streetName) }}</h3>
        <div class="meta">
          <span class="chip">{{ addr(f) }}</span>
          <span class="chip">Area: {{ f.areaSize }} ㎡</span>
          <span class="chip">Year: {{ f.yearBuilt }}</span>
          <span class="chip">AC: {{ f.hasAC ? 'Yes' : 'No' }}</span>
          <span class="chip">Available: {{ f.dateAvailable }}</span>
        </div>
        <div class="price">
          ${{ f.rentPrice | number : '1.0-0' }} <span class="unit">/month</span>
        </div>
      </div>

      <div class="ops" (click)="$event.stopPropagation()">
        <button class="btn ghost" (click)="toView($event, f.id)">View</button>
        <button class="btn ghost" (click)="toEdit($event, f.id)">Edit</button>
        <button class="btn danger" (click)="remove($event, f.id)">Delete</button>
      </div>
    </li>
  </ul>
</div>
